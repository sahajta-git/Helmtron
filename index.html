<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Helmtron - Smart Helmet Dashboard</title>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #0b1a2b;
      color: #f1c40f;
    }

    header {
      padding: 15px;
      background: #0b1a2b;
      border-bottom: 3px solid #f1c40f;
      text-align: center;
      font-size: 28px;
      font-weight: bold;
    }

    .hero {
      background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.7)),
        url("https://i.postimg.cc/Pf4v5Fkt/helmet-bg.jpg");
      height: 300px;
      background-size: cover;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: white;
    }

    .hero h2 {
      font-size: 35px;
      margin: 0;
      font-weight: bold;
    }

    .hero button {
      margin-top: 12px;
      background: #f1c40f;
      border: none;
      padding: 10px 18px;
      font-size: 18px;
      cursor: pointer;
      border-radius: 6px;
      font-weight: bold;
    }

    .section {
      padding: 25px;
      text-align: center;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 20px;
      padding: 20px;
      max-width: 1200px;
      margin: auto;
    }

    .card {
      background: #1b2f4b;
      border: 2px solid #f1c40f;
      border-radius: 12px;
      padding: 20px;
      font-size: 18px;
    }

    .danger {
      background: red;
      color: white;
      font-weight: bold;
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 15px;
      animation: blink 1s infinite;
    }

    @keyframes blink {
      50% { opacity: 0.5; }
    }

    footer {
      background: #0b1a2b;
      border-top: 2px solid #f1c40f;
      text-align: center;
      padding: 15px;
      font-size: 14px;
    }
  </style>
</head>

<body>
<header>Helmtron - Smart Safety Helmet</header>

<div class="hero">
  <h2>Live Safety Monitoring</h2>
  <p>Gas | Heart Rate | Temperature | Impact Alerts</p>
  <button onclick="scrollToSensors()">View Live Data</button>
</div>

<div class="section" id="sensorSection">
  <h2>Live Sensor Data</h2>
  <div id="alertBox"></div>

  <div class="grid" id="sensorGrid">
    <!-- Cards load via JS -->
  </div>
</div>

<footer>© 2025 Helmtron | NIIT University | Smart Safety System</footer>

<script>
const channelId = 3138290; // ✅ Your channel
const apiUrl = `https://api.thingspeak.com/channels/${channelId}/feeds.json?results=1`;

const sensors = {
  mq135: { label: "MQ135 Air Quality", field: "field1", unit: "PPM", limit: 300 },
  mq5: { label: "MQ5 Gas Level", field: "field2", unit: "PPM", limit: 200 },
  hr: { label: "Heart Rate", field: "field3", unit: "BPM", limit: 120 },
  spo2: { label: "SpO2", field: "field4", unit: "%", limit: 90, type: "lowBad" },
  temp: { label: "Temperature", field: "field5", unit: "°C", limit: 40 },
  hum: { label: "Humidity", field: "field6", unit: "%", limit: 80 },
  mpu: { label: "Impact Level (MPU)", field: "field7", unit: "g", limit: 2000 },
};

function scrollToSensors() {
  document.getElementById("sensorSection").scrollIntoView({ behavior: "smooth" });
}

async function fetchData() {
  try {
    const res = await fetch(apiUrl);
    const data = await res.json();
    const feed = data.feeds[0];

    let danger = false;
    let html = "";

    for (const key in sensors) {
      const s = sensors[key];
      const value = Number(feed[s.field]);
      const unsafe = s.type === "lowBad" ? value < s.limit : value > s.limit;

      if (unsafe) danger = true;

      html += `
        <div class="card">
          <strong>${s.label}</strong>
          <br>
          Value: ${isNaN(value) ? "--" : value + " " + s.unit}
          <br>
          Status: <b style="color:${unsafe ? "red" : "lightgreen"}">
          ${isNaN(value) ? "No Data" : unsafe ? "UNSAFE" : "Safe"}</b>
        </div>`;
    }

    document.getElementById("sensorGrid").innerHTML = html;
    document.getElementById("alertBox").innerHTML = danger ?
      `<div class='danger'>⚠️ Dangerous Condition Detected!</div>` : "";
  } catch (e) {
    document.getElementById("alertBox").innerHTML = "<div class='danger'>Error Loading Data</div>";
  }
}

fetchData();
setInterval(fetchData, 8000);
</script>
</body>
</html>
